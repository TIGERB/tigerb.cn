<!doctype html><html><head><meta charset=UTF-8><title>面向对象的设计过程 - By 施展</title><link rel=stylesheet href=//cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=//cdn.staticfile.org/prism/1.15.0/themes/prism.min.css><link rel=stylesheet href=//cdn.staticfile.org/KaTeX/0.10.0-rc.1/katex.min.css><link href=./css/chunk-vendors.5a8fa5d0.css rel=stylesheet></head><body><div><article id=webslides><section slide class="slide bg-black-blue aligncenter" image="https://images.unsplash.com/photo-1505238680356-667803448bb6?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80 .dark"><span class="background dark" style="background-image:url('https://images.unsplash.com/photo-1505238680356-667803448bb6?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80')"></span><div class=wrap wrap=true><h1 class=text-landing>面向对象的设计过程</h1><hr><p class="text-subtitle animated fadeInDown delay-800">By 施展</p></div></section><section slide class="slide aligncenter"><div class=wrap wrap=true><h2 class=gray2>前言</h2><hr><p class=text-intro>我一直认为分享的目的不是炫技。</p><div class=grid><div class=column><h6>一是，</h6><p>自我学习的总结。</p></div><div class=column><h6>二是，</h6><p>降低他人的学习成本。</p></div><div class=column><h6>三是，</h6><p>别人对自己学习结果的审核。</p></div></div></div></section><section slide class=slide><div class=wrap wrap=true><h3 class=gray3>本次分享有下面四个要素</h3><hr><div class="sms grid"><div class=column><h3>观点</h3><p>本次分享的观点是一个软件工程中的思维方法，不限于编程语言。</p></div><div class=column><h3>探讨</h3><p>我可能理解错的，或者大家没理解的，大家可以随时打断我，尽可能多互动，目的增加理解。</p></div><div class=column><h2>理解</h2><p>真的希望大家能理解。</p></div><div class=column><h2>运用</h2><p>最重要的，如果你觉着有帮助，一定要去在实际业务中实战。</p></div></div></div></section><section slide class="slide aligncenter"><div class=wrap wrap=true><h2>背景</h2><hr><p>工作中，几乎大家是不是经常抱怨别人写的代码-&gt;</p><ul><li>没法改</li><li>耦合高</li><li>无法扩展</li></ul></div><div class="slideInUp speaker-note"><div class=wrap><p>今天就来探讨如何<strong>克服</strong>上面的问题～</p></div></div></section><section slide class="slide aligncenter"><div class=wrap wrap=true><h2>场景</h2><hr><p>首先问个问题：</p><blockquote><p>平常工作中来了一个业务需求，我们是如何开始写代码的？</p></blockquote><p>我推测大多数人可能：</p><ul><li>1、梳理业务</li><li>2、设计数据库、接口、缓存</li><li>3、评审</li><li>4、于是就开始了 <code>怎么怎么样...如果怎么怎么样...怎么怎么样...</code>愉快的码代码的过程</li></ul><blockquote><p>此处有人觉着有啥问题么？</p></blockquote></div><div class=speaker-note><div class=wrap><p>备注：说出来问题的，本次分享就可以略过了~</p></div></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h4>一个简单的业务场景</h4><hr><div class="card-50 bg-white"><div class=flex-content><p class=text-intro>比如产品提了个需求： 描述刘超凡一天的生活，简单来看看他一天干些啥。</p><ul class=description><li>1.0 饿了吃饭</li><li>1.1 到点吃饭</li><li>2.0 渴了喝水</li><li>2.1 到点喝水</li><li>3.0 困了睡觉</li><li>3.1 到点睡觉</li><li>3.2 有可能一个人睡觉，也有可能... 是吧？复杂</li></ul></div><figure><img src=http://cdn.tigerb.cn/20191020234013.png alt=""></figure></div></div></section><section slide class=slide :class=size-200><div class="wrap size-200" wrap=true><h3>代码演化</h3><ul class="flexblock gallery"><li><a><figure><img src=http://cdn.tigerb.cn/20191020234051.png alt=""><figcaption><p>一个业务逻辑(拆成多个函数)从头写到尾</p></figcaption></figure></a></li><li><a><figure><img src=http://cdn.tigerb.cn/20191020234118.png alt=""><figcaption><p>一个业务逻辑(引入类)从头写到尾</p></figcaption></figure></a></li><li><a><figure><img src=http://cdn.tigerb.cn/20191020234526.png alt=""><figcaption><p>一个业务逻辑(拆成多个类方法)从头写到尾</p></figcaption></figure></a></li><li><a><figure><img src=http://cdn.tigerb.cn/20191020234848.png alt=""><figcaption><p>一个业务逻辑(拆成多类)从头写到尾</p></figcaption></figure></a></li></ul></div></section><section slide class="slide aligncenter size-50"><div class=wrap wrap=true><h4>典型的策略(状态)模式</h4><hr><p><img src=http://cdn.tigerb.cn/20191020235015.png alt=""></p><p>一个业务逻辑(拆成类、抽象类、接口)从头写到尾。</p></div></section><section slide class="slide aligncenter size-50"><div class=wrap wrap=true><h3>上面就是面向对象设计的代码结果</h3></div></section><section slide class="slide aligncenter size-50"><div class=wrap wrap=true><h2>思考🤔</h2><hr><blockquote><p>上面的代码就没啥问题了吗？</p></blockquote></div></section><section slide class="slide aligncenter size-50"><div class=wrap wrap=true><h2>思考🤔</h2><hr><blockquote><p>所以，如何设计出完全面向对象的代码？</p></blockquote></div></section><section slide class=slide><div class=wrap wrap=true><div class=cta><div class=number><h4>什么是代码建模？</h4></div><div class=benefit><p>把业务抽象成<strong>事物</strong>(类class、抽象类abstact class)和<strong>行为</strong>(接口interface)的过程。</p></div></div></div></section><section slide class="slide fullscreen"><div class=wrap wrap=true><div class=grid><div class=column><h4>实栗🌰分析</h4><p><code>--------------</code></p><p>看一个实际的业务场景：</p><p>最近刘超凡开始创业了，刚创立了一家电商公司，B2C，自营书籍《3分钟学会交际》。最近开始写提交订单的代码。</p><p>注意场景 1.刚创业 2.简单的单体应用 3.此处不探讨架构</p></div><div class=column><pre class=language-textile><code class=language-textile><span class="token phrase">定义接口API、设计数据库、缓存、技术评审等就开始码代码:
<span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span></span>

<span class="token phrase">接口参数：
uid
address_id
coupon_id
.etc</span>

<span class="token phrase">业务逻辑：
参数校验->
地址校验->
其他校验->
写订单表->
写订单商品信息表->
写日志->
扣减商品库存->
清理购物车->
扣减各种促销优惠活动的库存->
使用优惠券->
其他营销逻辑等等->
发送消息->
等等...
</span></code></pre></div></div></div></section><section slide class="slide fullscreen aligncenter"><div class=wrap wrap=true><h4>业务分析少不了</h4><hr><blockquote><p>换个角度看业务其实很简单：根据用户相关信息生成一个订单。</p></blockquote><div class=grid><div class=column><pre class=language-textile><code class=language-textile><span class="token phrase">1. 梳理得到业务逻辑:
<span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span>--</span>

<span class="token phrase">参数校验->
地址校验->
其他校验->
写订单表->
写订单商品信息表->
写日志->
扣减商品库存->
清理购物车->
扣减各种促销优惠活动的库存->
使用优惠券->
其他营销逻辑等等->
发送消息->
等等...
</span></code></pre></div><div class=column><pre class=language-textile><code class=language-textile><span class="token phrase">2. 梳理业务逻辑依赖信息:
<span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span><span class="token inline"><span class="token punctuation">-</span><span class="token deleted">-</span><span class="token punctuation">-</span></span>--</span>

<span class="token phrase">用户信息
商品信息
地址信息
优惠券信息
等等...
</span></code></pre></div></div></div></section><section slide class=slide :class=size-70><div class="wrap size-70" wrap=true><h2 class=aligncenter>获取事物</h2><hr><div class="quote card-50"><blockquote><p>比如，我们把订单生成的过程可以想象成<strong>机器人</strong>，一个生成订单的<strong>订单生成机器人</strong>。</p></blockquote><figure><img src=http://cdn.tigerb.cn/20191020223812.jpg alt=""></figure><p></p></div></div></section><section slide class=slide :class=size-70><div class="wrap size-70" wrap=true><h2 class=aligncenter>获取行为</h2><hr><div class="quote card-50"><blockquote><p>行为呢？毫无义务就是上面各种业务逻辑。</p></blockquote><figure><img src=http://cdn.tigerb.cn/20191020224230.jpg alt=""></figure><p></p></div></div></section><section slide class=slide :class=size-70><div class="wrap size-70" wrap=true><h2 class=aligncenter>得到UML</h2><hr><div class="quote card-50"><p><img src=http://cdn.tigerb.cn/20191020233121.png alt=""></p></div></div></section><section slide class=slide :class=size-200><div class="wrap size-200" wrap=true><h3>设计代码</h3><hr><ul class="flexblock gallery"><li><a><p><br></p><p><code>1. 定义一个类</code> <img src=http://cdn.tigerb.cn/20191020235309.png alt=""></p></a></li><li><a><p><br></p><p><code>2. 定义一个订单创建行为的接口</code> <img src=http://cdn.tigerb.cn/20191020235643.png alt=""></p></a></li><li><a><p><br></p><p><code>3. 定义具体的不同订单创建行为类</code> <img src=http://cdn.tigerb.cn/20191020235840.png alt=""></p></a></li></ul></div></section><section slide class=slide :class=size-200><div class="wrap size-200" wrap=true><h3>创建订单</h3><hr><ul class="flexblock gallery"><li><a><p><br></p><p><code>这里的代码该怎么写，这样？</code> <img src=http://cdn.tigerb.cn/20191021000742.png alt=""></p></a></li><li><a><p><br></p><p><code>还可以继续优化吗？🤔️</code> <img src=http://cdn.tigerb.cn/20191021001002.png alt=""></p></a></li><li><a><p><br></p><p><code>使用闭包。</code> <img src=http://cdn.tigerb.cn/20191021001305.png alt=""></p></a></li></ul></div></section><section slide class=slide :class=size-40><div class="wrap size-40" wrap=true><h2>PHP完整代码</h2><hr><div class="quote card-50"><p><img src=http://cdn.tigerb.cn/20191024143840.png alt=""></p></div></div></section><section slide class=slide :class=size-50><div class="wrap size-50" wrap=true><h2>Go完整代码</h2><hr><div class="quote card-50"><p><img src=http://cdn.tigerb.cn/20191024144623.png alt=""></p></div></div></section><section slide class=slide :class="size-80 aligncenter"><div class="wrap size-80 aligncenter" wrap=true><h4>上面的代码有什么好处？🤔️</h4><hr><div class="quote card-50"><blockquote><p>假如刘超凡又要新开发一个新的应用。去除优惠逻辑、新增了增加用户积分的逻辑。</p></blockquote><figure><img src=http://cdn.tigerb.cn/20191021001739.png alt=""></figure><p></p></div></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h2>所以，现在，什么是面向对象？😖</h2></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h2>面向对象的设计原则</h2><hr><ul><li>对接口编程而不是对实现编程</li><li>优先使用对象组合而不是继承</li><li>抽象用于不同的事物，而接口用于事物的行为</li></ul></div></section><section slide class="slide size-100 aligncenter"><div class=wrap wrap=true><h4>回归代码</h4><hr><ul class="flexblock gallery"><li><a><figure><img src=http://cdn.tigerb.cn/20190714103845.jpg alt=""><figcaption><blockquote><p>1.对接口编程而不是对实现编程</p></blockquote><pre class=language-textile><code class=language-textile><span class="token phrase">结果：RobotOrderCreate依赖了BehaviorOrderCreateInterface抽象接口
</span></code></pre><blockquote><p>2.优先使用对象组合而不是继承</p></blockquote><pre class=language-textile><code class=language-textile><span class="token phrase">结果：完全没有使用继承，多个行为不同场景组合使用
</span></code></pre><blockquote><p>3.抽象用于不同的事物，而接口用于事物的行为</p></blockquote><pre class=language-textile><code class=language-textile><span class="token phrase">结果：
1. 抽象了一个创建订单的机器人 RobotOrderCreate
2. 机器人又有不同的创建行为
3. 机器人的创建行为最终依赖于BehaviorOrderCreateInterface接口
</span></code></pre></figcaption></figure></a></li><li><a><figure><img src=http://cdn.tigerb.cn/20191024143840.png alt=""><figcaption></figcaption></figure></a></li></ul></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h2>是不是完美契合，所以这就是“面向对象的设计过程”。😄</h2></div></section><section slide class=slide :class=aligncenter><div class="wrap aligncenter" wrap=true><h2>预习</h2><hr><h4>设计模式又是什么？</h4></div><div class=speaker-note><div class=wrap><p>前人面向对象编程过程中的经验总结</p></div></div></section><section slide class="slide size-60 aligncenter"><div class=wrap wrap=true><h4>设计模式的设计原则（开闭原则）</h4><hr><ul class="flexblock gallery"><li><a><figure><img src=http://cdn.tigerb.cn/20191022131439.png alt=""><figcaption><h2>开闭原则：对扩展开放，对修改封闭</h2></figcaption></figure></a></li></ul></div></section><section slide class="slide size-60 aligncenter"><div class=wrap wrap=true><h3>设计模式的设计原则</h3><hr><ul><li>开闭原则：对扩展开放，对修改封闭</li><li>里氏代换：超类（父类）出现的地方，派生类（子类）都可以出现</li><li>依赖倒转：对接口编程，依赖于抽象而不依赖于具体</li><li>接口隔离：使用多个接口，而不是对一个接口编程，去依赖降低耦合</li><li>合成复用：多个独立的实体合成聚合，而不是使用继承</li><li>迪米特法则，又称最少知道原则：减少内部依赖，尽可能的独立</li></ul><div></div></div></section><section slide class="slide size-60 aligncenter"><div class=wrap wrap=true><h3>下回预告👋</h3><hr><p>上面预习了设计模式的概念，下次我们进行《设计模式业务实战》。</p></div></section><section slide class="slide size-60 aligncenter"><div class=wrap wrap=true><h3>完了？没有～ 重点来了</h3></div></section><section slide class="slide size-60 aligncenter"><div class=wrap wrap=true><h3>😨作业😨</h3><hr><p>找一个你最近写过的业务，重新设计你的业务代码。</p></div></section></article></div><script>window.pluginsOptions = {}



document.addEventListener('DOMContentLoaded', () => {
    let isPrintMode = false;
    if(~location.search.indexOf('print-pdf')){
        isPrintMode = true;
        WebSlides.registerPlugin('scroll', function(){});
    }
    const ws = new WebSlides({
        loop: false
    })
    window.wsInstance = ws;
    if(isPrintMode){
        ws.slides.forEach(s=>s.show())
    }
}, false)</script><script src=./js/chunk-vendors.bd01939e.js></script><script src=./js/oop.fb76292f.js></script></body></html>